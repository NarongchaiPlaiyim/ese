<!DOCTYPE html>
<html>
<f:view xmlns="http://www.w3.org/1999/xhtml"
        xmlns:f="http://java.sun.com/jsf/core"
        xmlns:h="http://java.sun.com/jsf/html"
        xmlns:ui="http://java.sun.com/jsf/facelets"
        xmlns:p="http://primefaces.org/ui">
<h:head>
    <title>#{msg.get('menu.user.title')}</title>
</h:head>
<h:body>
<p:layout fullPage="true" id="layoutPanel">
    <p:layoutUnit id="layoutTop" position="north" size="180" header="#{msg.get('header.north')}" collapsible="true" style="border: 0">
        <ui:include src="#{msg.get('include.header')}"/>
    </p:layoutUnit>
    <p:layoutUnit id="layoutLeft" position="west" size="250" header="#{msg.get('header.west')}" collapsible="true" style="border: 0">
        <ui:include src="#{msg.get('include.menu')}"/>
    </p:layoutUnit>

    <p:layoutUnit id="layoutCenter" position="center" header="#{msg.get('menu.user.title')}" >
        <h:form id="userManagementForm">
        <h:form id="mainForm" style="width: 100%;border-spacing: 0;">
        <p:tabView id="manegementTab" cache="false" dynamic="false" style="border: 0">
        <p:tab id="userManageSub" title="8.1 User Management">
            <p:panel style="border: 0">
                <div style="text-align: right;">
                    <h:outputLabel id="modeUserAccess" value="#{userManagement.modeUserManage}"/>
                    <p:commandButton id="btnAddUser" value="Add User"
                                     styleClass="medium" style="#{msg.get('btn.size')}"
                                     process="@form"
                                     action="#{userManagement.onClickNewUser('New')}"
                                     update=":addUserForm"
                                     icon="ui-icon-plusthick"
                                     oncomplete="PF('addUserDlg').show()"/>
                    <p:commandButton id="btnEdit" value="#{msg.get('btn.name.edit')}"
                                     styleClass="medium" style="#{msg.get('btn.size')}"
                                     process="@form"
                                     disabled="#{userManagement.flagBtnEdit}"
                                     action="#{userManagement.onClickNewUser('Edit')}"
                                     update=":addUserForm"
                                     icon="ui-icon-wrench"
                                     oncomplete="PF('addUserDlg').show()"/>
                    <p:commandButton id="btnDelete" value="#{msg.get('btn.name.delete')}"
                                     styleClass="medium" style="#{msg.get('btn.size')}"
                                     process="@form"
                                     disabled="#{userManagement.flagBtnDelete}"
                                     action="#{userManagement.preDelete}"
                                     icon="ui-icon-trash"
                                     onstart="PF('bui').block()"
                                     oncomplete="PF('bui').unblock()"
                                     update=":msgBoxSystemMessagePanel,
                                                                                     :confirmUserAccessPanel"/>
                    <p:commandButton id="btnUserAccess" value="User Access"
                                     styleClass="medium" style="#{msg.get('btn.size')}"
                                     process="@form"
                                     disabled="#{userManagement.flagUserAccess}"
                                     action="#{userManagement.onClickUserAccessDialog}"
                                     update=":userAccessForm"
                                     oncomplete="PF('userAccessDlg').show()"/>
                    <p:commandButton id="btnPrint"
                                     value="#{msg.get('btn.name.print')}"
                                     process="@form"
                                     disabled="#{userManagement.flagPrint}"
                                     onstart="PF('bui').block()"
                                     oncomplete="PF('bui').unblock()"
                                     ajax="false"
                                     icon="ui-icon-script"
                                     styleClass="medium" style="#{msg.get('btn.size')}"/>
                </div>
            </p:panel>
            <table border="0" style="width: 100%">
                <tr>
                    <td>
                        <table border="0">
                            <tr>
                                <td>
                                    <h:outputLabel value="Department"/>
                                </td>
                                <td style="min-width: 210px; width: 210px; max-width: 210px;">
                                    <p:selectOneMenu id="departmentMenu"  value="#{userManagement.msDepartmentModel.id}"
                                                     style="min-width: 200px; width: 200px; max-width: 200px;">
                                        <f:selectItem itemLabel="All" itemValue=""/>
                                        <f:selectItems value="#{userManagement.msDepartmentModelList}"
                                                       var="departmentItem"
                                                       itemLabel="#{departmentItem.name}"
                                                       itemValue="#{departmentItem.id}"/>
                                        <p:ajax event="change" process="@form" listener="#{userManagement.onChangeSearchMenu('department')}"
                                                update=":userManagementForm:mainForm:manegementTab:userTable,
                                                                                    :userManagementForm:mainForm:manegementTab:factionMenu"/>
                                    </p:selectOneMenu>
                                </td>
                                <td>
                                    <h:outputLabel value="Faction"/>
                                </td>
                                <td>
                                    <p:selectOneMenu id="factionMenu" value="#{userManagement.factionModel.id}"
                                                     style="min-width: 200px; width: 200px; max-width: 200px;">
                                        <f:selectItem itemLabel="- Please Select -" itemValue=""/>
                                        <f:selectItems value="#{userManagement.factionModelList}"
                                                       var="factionItem"
                                                       itemLabel="#{factionItem.name}"
                                                       itemValue="#{factionItem.id}"/>
                                        <p:ajax event="change" process="@form" listener="#{userManagement.onChangeSearchMenu}"
                                                update=":userManagementForm:mainForm:manegementTab:userTable"/>
                                    </p:selectOneMenu>
                                </td>
                                <td style="width: 110px">
                                    <p:inputText id="searchText" value="#{userManagement.keySearchUser}" style="width: 120px">
                                        <p:ajax event="blur" update=":userManagementForm:mainForm:manegementTab:searchText"/>
                                    </p:inputText>
                                </td>
                                <td style="width: 40px; min-width: 40px; max-width: 40px">
                                    <p:commandButton id="btnsearch" icon="ui-icon-search"
                                                     onstart="PF('bui').block()"
                                                     oncomplete="PF('bui').unblock()"
                                                     process="@form"
                                                     value="#{msg.get('btn.name.search')}"
                                                     styleClass="medium" style="#{msg.get('btn.size')}"
                                                     actionListener="#{userManagement.onChangeSearchMenu}"
                                                     update=":userManagementForm:mainForm:manegementTab:userTable"/>
                                </td>
                            </tr>
                        </table>
                    </td>
                </tr>
                <tr>
                    <td>
                        <p:dataTable id="userTable" rowIndexVar="rowIndex"
                                     styleClass="full_table"
                                     rows="8" paginator="true"
                                     rowKey="#{user.id}"
                                     value="#{userManagement.staffModelList}"
                                     var="user"
                                     selection="#{userManagement.staffModel}"
                                     selectionMode="single"
                                     style="width: 100%; max-width: 100%; min-width: 100%">
                            <p:ajax event="rowSelect" listener="#{userManagement.onClickUserAccess}"
                                    update=":userManagementForm:mainForm:manegementTab"/>
                            <p:column headerText="No" style="width: 20px" styleClass="center">
                                <h:outputText value="#{rowIndex+1}"/>
                            </p:column>
                            <p:column headerText="Department " style="width: 70px; max-width: 70px; min-width: 70px" styleClass="center">
                                <h:outputText value="#{user.factionModel.msDepartmentModel.name}" />
                            </p:column>
                            <p:column headerText="Faction" style="width: 70px; max-width: 70px; min-width: 70px" styleClass="center">
                                <h:outputText value="#{user.factionModel.name}"/>
                            </p:column>
                            <p:column headerText="Name" style="width: 80px; max-width: 80px; min-width: 80px" styleClass="center">
                                <h:outputText value="#{user.msTitleModel.name} #{user.name}"/>
                            </p:column>
                            <p:column headerText="Position" style="width: 115px; max-width: 115px; min-width: 115px" styleClass="center">
                                <h:outputText value="#{user.position}"/>
                            </p:column>
                            <p:column headerText="Login Name" style="width: 150px" styleClass="center">
                                <h:outputText value="#{user.username}"/>
                            </p:column>
                            <p:column headerText="Role" style="width: 100px" styleClass="center">
                                <h:outputText value="#{user.role}"/>
                            </p:column>
                        </p:dataTable>
                    </td>
                </tr>
            </table>
        </p:tab>
        <p:tab id="roleAccessSub" title="8.2 Role Access">
            <p:panel style="border: 0">
                <div style="text-align: right;">
                    <p:commandButton value="#{msg.get('btn.name.new')}"
                                     id="btnNewRole"
                                     styleClass="medium" style="#{msg.get('btn.size')}"
                                     icon="ui-icon-plusthick" />
                    <p:commandButton value="#{msg.get('btn.name.save')}"
                                     id="btnSaveRole"
                                     styleClass="medium" style="#{msg.get('btn.size')}"
                                     icon="ui-icon-check"
                                     onstart="PF('bui').block()"
                                     oncomplete="PF('bui').unblock()"/>
                    <p:commandButton value="#{msg.get('btn.name.delete')}"
                                     id="btnDeleteRole"
                                     styleClass="medium" style="#{msg.get('btn.size')}"
                                     icon="ui-icon-trash"
                                     onstart="PF('bui').block()"
                                     oncomplete="PF('bui').unblock()" />
                </div>
            </p:panel>

            <table border="0" style="width: 100%">
                <tr>
                    <td class="top">
                        <table border="0" style="width: 50%; border: 1px solid #acacac; border-spacing: 0; margin-top: 10px;">
                            <tr>
                                <td class="titlemenu" colspan="2">
                                    <h:outputLabel value="Role"/>
                                </td>
                            </tr>
                            <tr>
                                <td class="right" colspan="2">

                                </td>
                            </tr>
                            <tr>
                                <td style="width: 65px; min-width: 65px; max-width: 65px">
                                    <h:outputLabel value="Role Name"/>
                                </td>
                                <td>
                                    <p:inputText/>
                                </td>
                            </tr>
                            <tr>
                                <td/>
                                <td>
                                    <p:inputText/>
                                    <p:commandButton id="btnSearchRole" icon="ui-icon-search"
                                                     value="#{msg.get('btn.name.search')}"
                                                     styleClass="medium" style="#{msg.get('btn.size')}"
                                                     onstart="PF('bui').block()"
                                                     oncomplete="PF('bui').unblock()"
                                                     process="@form"/>
                                </td>
                            </tr>
                            <tr>
                                <td colspan="2" class="top">
                                    <p:dataTable id="roleTable" rowIndexVar="rowIndex"
                                                 styleClass="full_table"
                                                 rows="5" paginator="true"
                                                 selectionMode="single"
                                                 style="width: 100%; max-width: 100%; min-width: 100%">
                                        <p:ajax event="rowSelect"/>
                                        <p:column headerText="No" style="width: 20px; min-width: 20px; max-width: 20px" styleClass="center">
                                            <h:outputText value="#{rowIndex+1}"/>
                                        </p:column>
                                        <p:column headerText="Role Name" style="width: 450px; max-width: 450px; min-width: 450px" styleClass="center">
                                            <h:outputText value="" />
                                        </p:column>
                                    </p:dataTable>
                                </td>
                            </tr>
                        </table>
                    </td>
                    <td/>
                    <td class="top">
                        <table border="0" style="width: 50%; border: 1px solid #acacac; border-spacing: 0; margin-top: 10px;">
                            <tr>
                                <td class="titlemenu" colspan="2">
                                    <h:outputLabel value="Role Access"/>
                                </td>
                            </tr>
                            <tr>
                                <td class="right" colspan="2">
                                    <p:commandButton value="#{msg.get('btn.name.add')}"
                                                     id="btnAddRoleAccess"
                                                     styleClass="medium" style="#{msg.get('btn.size')}"
                                                     icon="ui-icon-plusthick"
                                                     oncomplete="PF('userRoleAccessDlg').show()"/>
                                    <p:commandButton value="#{msg.get('btn.name.delete')}"
                                                     id="btnDeleteRoleAccess"
                                                     styleClass="medium" style="#{msg.get('btn.size')}"
                                                     icon="ui-icon-trash"
                                                     onstart="PF('bui').block()"
                                                     oncomplete="PF('bui').unblock()" />
                                </td>
                            </tr>
                            <tr>
                                <td class="right" >
                                    <p:selectOneMenu id="roleMenu"
                                                     style="min-width: 150px; width: 150px; max-width: 150px;
                                                                             margin-right: 15px">
                                        <f:selectItem itemLabel="- Please Select -" itemValue=""/>
                                    </p:selectOneMenu>
                                </td>
                                <td>
                                    <p:inputText/>
                                    <p:commandButton id="btnSearchRoleAccess" icon="ui-icon-search"
                                                     value="#{msg.get('btn.name.search')}"
                                                     styleClass="medium" style="#{msg.get('btn.size')}"
                                                     onstart="PF('bui').block()"
                                                     oncomplete="PF('bui').unblock()"
                                                     process="@form"/>
                                </td>
                            </tr>
                            <tr>
                                <td colspan="2" class="top">
                                    <p:dataTable id="roleAccessTable" rowIndexVar="rowIndex"
                                                 styleClass="full_table"
                                                 rows="5" paginator="true"
                                                 selectionMode="single"
                                                 style="width: 100%; max-width: 100%; min-width: 100%">
                                        <p:ajax event="rowSelect"/>
                                        <p:column selectionMode="multiple" style="width:16px;text-align:center; height: 20px"/>
                                        <p:column headerText="Code" style="width: 100px; max-width: 100px; min-width: 100px" styleClass="center">
                                            <h:outputText value="" />
                                        </p:column>
                                        <p:column headerText="Menu Object and Action" style="width: 300px; max-width: 300px; min-width: 300px" styleClass="center">
                                            <h:outputText value="" />
                                        </p:column>
                                    </p:dataTable>
                                </td>
                            </tr>
                        </table>
                    </td>
                </tr>
            </table>
        </p:tab>
        </p:tabView>
        </h:form>
        </h:form>
    </p:layoutUnit>
</p:layout>

<p:dialog id="addUserDialog" widgetVar="addUserDlg" header="Add/Edit User"
          onShow="hideWindowsScrollBar()" onHide="showWindowsScrollBar()" resizable="false"
          modal="true" width="1000" height="450">
    <ui:include src="../site/dialog/addUserDialog.xhtml"/>
</p:dialog>

<p:dialog id="userAccessDialog" widgetVar="userAccessDlg" header="User Access"
          onShow="hideWindowsScrollBar()" onHide="showWindowsScrollBar()" resizable="false"
          modal="true" width="1024" height="450">
    <ui:include src="../site/dialog/userAccessDialog.xhtml"/>
</p:dialog>

<p:dialog id="userRoleDialog" widgetVar="userRoleDlg" header="Add User Role"
          onShow="hideWindowsScrollBar()" onHide="showWindowsScrollBar()" resizable="false"
          modal="true" width="1000" height="450">
    <ui:include src="../site/dialog/addUserRoleDialog.xhtml"/>
</p:dialog>

<p:dialog id="userRoleAccessDialog" widgetVar="userRoleAccessDlg" header="Menu and Action List"
          onShow="hideWindowsScrollBar()" onHide="showWindowsScrollBar()" resizable="false"
          modal="true" width="1000" height="450">
    <ui:include src="../site/dialog/addRoleAccessDialog.xhtml"/>
</p:dialog>

<p:panel id="msgBoxSystemMessagePanel" style="border: 0">
    <p:confirmDialog id="msgBoxSystemMessageDialog" widgetVar="msgBoxSystemMessageDlg" width="#{msg.get('dialog.message.size')}" closable="false"
                     header="#{userManagement.messageHeader}" message="#{userManagement.message}" >
        <div style="text-align: right">
            <p:commandButton value="#{msg.get('btn.name.ok')}"
                             process="@this"
                             update=":userManagementForm:mainForm:manegementTab"
                             icon="ui-icon-check"
                             styleClass="medium" style="#{msg.get('btn.size')}"
                             oncomplete="PF('msgBoxSystemMessageDlg').hide()"/>
        </div>
    </p:confirmDialog>
</p:panel>

<p:panel id="confirmUserAccessPanel" style="border: 0">
    <p:confirmDialog id="confirmUserAccessDialog" widgetVar="confirmUserAccessDlg" width="#{msg.get('dialog.message.size')}"
                     closable="false"
                     header="#{userManagement.messageHeader}" message="#{userManagement.message}">
        <div style="text-align: right">
            <p:commandButton value="#{msg.get('btn.name.ok')}" action="#{userManagement.onDeleteUserAccess()}"
                             process="@this" update=":userManagementForm:mainForm:manegementTab, :msgBoxSystemMessagePanel"
                             styleClass="medium" style="#{msg.get('btn.size')}"
                             icon="ui-icon-check"
                             oncomplete="PF('confirmUserAccessDlg').hide()"/>
            <p:commandButton value="#{msg.get('btn.name.cancel')}"
                             process="@this"
                             update=":userManagementForm:mainForm:manegementTab"
                             styleClass="medium" style="#{msg.get('btn.size')}"
                             icon="ui-icon-cancel"
                             oncomplete="PF('confirmUserAccessDlg').hide()"/>
        </div>
    </p:confirmDialog>
</p:panel>
</h:body>
</f:view>
</html>